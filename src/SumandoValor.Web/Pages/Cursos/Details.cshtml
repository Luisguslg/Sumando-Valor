@page "/Cursos/{id:int}"
@model SumandoValor.Web.Pages.Cursos.DetailsModel
@using SumandoValor.Domain.Entities
@{
    ViewData["Title"] = Model.Curso?.Titulo ?? "Programa Formativo";
}

@if (Model.Curso == null)
{
    <div class="alert alert-warning">
        <p class="mb-0">Programa Formativo no encontrado.</p>
    </div>
    <a asp-page="/Cursos" class="btn btn-secondary">Volver a Programa Formativo</a>
}
else
{
    @await Html.PartialAsync("_PageHeader", new SumandoValor.Web.Pages.Shared.PageHeaderModel
    {
        Title = Model.Curso.Titulo,
        Subtitle = string.IsNullOrWhiteSpace(Model.Curso.PublicoObjetivo) ? "Programa Formativo" : $"PÃºblico objetivo: {Model.Curso.PublicoObjetivo}",
        UseBrandBackground = false
    })

    <div class="container my-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="h4 fw-bold mb-1">Talleres (eventos)</h2>
                <div class="text-muted">Selecciona un taller para ver detalles e inscribirte.</div>
            </div>
            <a asp-page="/Cursos" class="btn btn-outline-secondary btn-sm">Volver</a>
        </div>

        @if (Model.Talleres == null || !Model.Talleres.Any())
        {
            <div class="alert alert-info">
                <i class="bi bi-info-circle me-2"></i>
                <p class="mb-0">No hay talleres disponibles para este Programa Formativo.</p>
            </div>
        }
        else
        {
            <div class="row g-4">
                @foreach (var taller in Model.Talleres)
                {
                    <div class="col-md-6">
                        @await Html.PartialAsync("_WorkshopCard", new SumandoValor.Web.Pages.Shared.WorkshopCardModel
                        {
                            TallerId = taller.Id,
                            Title = taller.Titulo,
                            Description = taller.Descripcion,
                            FechaInicio = taller.FechaInicio,
                            HoraInicio = taller.HoraInicio,
                            Modalidad = taller.Modalidad,
                            CuposDisponibles = taller.CuposDisponibles,
                            CuposMaximos = taller.CuposMaximos,
                            Estatus = taller.Estatus,
                            CursoTitle = Model.Curso?.Titulo,
                            PrimaryCtaText = "Ver evento",
                            PrimaryCtaPage = "/Talleres/Details"
                        })
                    </div>
                }
            </div>
        }
    </div>
}
